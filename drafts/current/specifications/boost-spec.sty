% boost-spec.sty - LaTeX package for BOOST Specification
% Complete style package for W3C-compliant documentation

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{boost-spec}[2025/08/22 {{VERSION}} BOOST Specification Style]

% Required packages
\RequirePackage{xcolor}
\RequirePackage[skins,breakable]{tcolorbox}
\RequirePackage{hyperref}
\RequirePackage{amsmath}
\RequirePackage{amsfonts}
\RequirePackage{amssymb}
\RequirePackage{booktabs}
\RequirePackage{url}
\RequirePackage{longtable}
\RequirePackage{float}
\RequirePackage{fancyhdr}
\RequirePackage[utf8]{inputenc}
\RequirePackage{listings}
\RequirePackage{minted}
\RequirePackage[T1]{fontenc}
\RequirePackage{fourier}   % Utopia fonts with Fourier math (exact minted documentation style)
\RequirePackage{textcomp}
% Explicitly configure Latin Modern Sans and Mono (matching minted docs)
\renewcommand{\sfdefault}{lmss}  % Latin Modern Sans
\renewcommand{\ttdefault}{lmtt}  % Latin Modern Mono
\RequirePackage{makeidx}
\RequirePackage{parskip}   % Better paragraph spacing
\makeindex  % Enable indexing
\DeclareUnicodeCharacter{2265}{\ensuremath{\geq}}
\DeclareUnicodeCharacter{2264}{\ensuremath{\leq}}

% Simplified color scheme (minted documentation style)
\definecolor{codebackground}{RGB}{245,245,245}  % Light gray for code
\definecolor{codeborder}{RGB}{204,204,204}      % Light gray border
\definecolor{linkcolor}{RGB}{0,0,139}           % Dark blue for links
\definecolor{rulecolor}{RGB}{128,128,128}       % Gray for rules
\definecolor{examplecolor}{RGB}{102,102,102}    % Dark gray for examples
\definecolor{example}{RGB}{102,102,102}        % Alias for minted compatibility
\definecolor{warningcolor}{RGB}{178,34,34}      % Dark red for warnings
\definecolor{w3cblue}{RGB}{0,0,139}             % W3C blue for hyperlinks
\definecolor{reference}{RGB}{139,0,0}           % Dark red for references

% Minted configuration for syntax highlighting (compatible with TeX Live 2021+)
\setminted{
    fontsize=\small,
    linenos=false,
    breaklines=true,
    tabsize=2,
    bgcolor=codebackground,
    frame=leftline,
    framerule=1pt,
    rulecolor=codeborder
}

% Enhanced listings configuration (simplified minted style)
\lstdefinelanguage{JSON}{
    basicstyle=\ttfamily\footnotesize,
    numbers=left,
    numberstyle=\tiny\color{rulecolor},
    stepnumber=1,
    numbersep=8pt,
    showstringspaces=false,
    breaklines=true,
    frame=leftline,
    backgroundcolor=\color{codebackground},
    rulecolor=\color{codeborder}
}

\lstdefinestyle{jsonStyle}{
    language=JSON,
    basicstyle=\ttfamily\footnotesize,
    keywordstyle=\color{linkcolor},
    stringstyle=\color{examplecolor},
    commentstyle=\color{rulecolor}\itshape,
    numbers=left,
    numberstyle=\tiny\color{rulecolor},
    stepnumber=1,
    numbersep=8pt,
    tabsize=2,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    frame=leftline,
    framerule=1pt,
    rulecolor=\color{codeborder},
    backgroundcolor=\color{codebackground},
    breaklines=true,
    breakatwhitespace=false,
    escapeinside={(*@}{@*)}
}

% Custom environments (Latin Modern fonts matching minted documentation)
\newtcolorbox{normative}[1][]{
    colback=codebackground,
    colframe=codeborder,
    title={\textbf{Normative Section}},
    fonttitle=\bfseries,
    boxrule=0.5pt,
    #1
}

\newtcolorbox{informative}[1][]{
    colback=codebackground,
    colframe=codeborder,
    title={\textbf{Informative Section}},
    fonttitle=\bfseries,
    boxrule=0.5pt,
    #1
}

\newtcolorbox{examplebox}[1][]{
    colback=codebackground,
    colframe=examplecolor,
    title={\textbf{Example}},
    fonttitle=\bfseries,
    boxrule=0.5pt,
    #1
}

\newtcolorbox{important}[1][]{
    colback=white,
    colframe=warningcolor,
    title={\textbf{Important}},
    fonttitle=\bfseries,
    boxrule=1pt,
    #1
}

% RFC 2119 keyword formatting
\newcommand{\rfc}[1]{\textbf{\textsc{#1}}}
\newcommand{\MUST}{\rfc{must}}
\newcommand{\MUSTNOT}{\rfc{must not}}
\newcommand{\REQUIRED}{\rfc{required}}
\newcommand{\SHALL}{\rfc{shall}}
\newcommand{\SHALLNOT}{\rfc{shall not}}
\newcommand{\SHOULD}{\rfc{should}}
\newcommand{\SHOULDNOT}{\rfc{should not}}
\newcommand{\RECOMMENDED}{\rfc{recommended}}
\newcommand{\MAY}{\rfc{may}}
\newcommand{\OPTIONAL}{\rfc{optional}}

% Entity formatting
\newcommand{\entity}[1]{\texttt{#1}}
\newcommand{\field}[1]{\texttt{#1}}
\newcommand{\enum}[1]{\texttt{#1}}
\newcommand{\TRU}{\entity{TraceableUnit}}

% Thematic area formatting commands
\newcommand{\coretraceability}[1]{\textbf{#1}}
\newcommand{\organizational}[1]{\textbf{#1}}
\newcommand{\material}[1]{\textbf{#1}}
\newcommand{\materialsupply}[1]{\textbf{#1}}
\newcommand{\transaction}[1]{\textbf{#1}}
\newcommand{\measurement}[1]{\textbf{#1}}
\newcommand{\sustainability}[1]{\textbf{#1}}
\newcommand{\geographic}[1]{\textbf{#1}}
\newcommand{\compliance}[1]{\textbf{#1}}
\newcommand{\reporting}[1]{\textbf{#1}}

% Use standard LaTeX section formatting (Computer Modern)

% Simple W3C Specification metadata commands
% These commands are not used in this minimal implementation
% All metadata is hardcoded in \makew3ctitle command

% Cross-reference formatting
\newcommand{\secref}[1]{Section~\ref{#1}}
\newcommand{\figref}[1]{Figure~\ref{#1}}
\newcommand{\tabref}[1]{Table~\ref{#1}}
\newcommand{\appref}[1]{Appendix~\ref{#1}}

% JSON example environment (Latin Modern fonts matching minted documentation)
\newtcolorbox{jsonexample}[2][]{
    enhanced,
    colback=codebackground,
    colframe=codeborder,
    title={\textbf{JSON Example: #2}},
    fonttitle=\bfseries,
    boxrule=0.5pt,
    breakable=true,
    left=8pt,
    right=8pt,
    top=8pt,
    bottom=8pt,
    before skip=10pt,
    after skip=10pt,
    #1
}

% Enhanced code listing environments (Latin Modern fonts matching minted documentation)
\newenvironment{codeblock}[2][]{
    \begin{tcolorbox}[colback=codebackground,colframe=codeborder,title={\textbf{#2}},fonttitle=\bfseries,boxrule=0.5pt]
    \begin{lstlisting}[#1]
}{
    \end{lstlisting}
    \end{tcolorbox}
}

% Removed problematic \jsoncode command - use minted directly instead

% New minted-based commands (simplified styling)
\newcommand{\mintjson}[1]{%
    \begin{minted}[
        bgcolor=codebackground,
        frame=leftline,
        framerule=1pt,
        rulecolor=codeborder,
        fontsize=\small
    ]{json}
    #1
    \end{minted}
}

\newcommand{\mintpython}[1]{%
    \begin{minted}[
        bgcolor=codebackground,
        frame=leftline,
        framerule=1pt,
        rulecolor=codeborder,
        fontsize=\small,
        linenos=true
    ]{python}
    #1
    \end{minted}
}

% Inline code formatting commands (simplified styling)
\newcommand{\inlinejson}[1]{\texttt{\textcolor{examplecolor}{#1}}}
\newcommand{\inlinecode}[1]{\texttt{#1}}

% Python example environment (Latin Modern fonts matching minted documentation)
\newtcolorbox{pythonexample}[1]{
    enhanced,
    colback=codebackground,
    colframe=codeborder,
    title={\textbf{Python Example: #1}},
    fonttitle=\bfseries,
    boxrule=0.5pt,
    breakable=true,
    before skip=10pt,
    after skip=10pt
}

% Python code command (simplified styling)
\newcommand{\pythoncode}[1]{%
    \begin{minted}[
        fontsize=\small,
        linenos=false,
        breaklines=true,
        bgcolor=codebackground
    ]{python}
#1
    \end{minted}%
}

% Inline code formatting command
\newcommand{\code}[1]{\texttt{#1}}

% Entity definition table environment
\newenvironment{entitytable}[1]{%
    \begin{table}[H]
    \centering
    \caption{Entity Definition: #1}
    \begin{tabular}{@{}lp{0.3\textwidth}p{0.4\textwidth}@{}}
    \toprule
    \textbf{Field} & \textbf{Type} & \textbf{Description} \\
    \midrule
}{%
    \bottomrule
    \end{tabular}
    \end{table}
}

% W3C Status environment
\newenvironment{w3cstatus}{%
    \begin{informative}[title=Status of This Document]
}{%
    \end{informative}
}

% Standard title page (Latin Modern fonts like minted documentation)
\newcommand{\boosttitle}{%
    \begin{titlepage}
    \centering
    \vspace*{3cm}
    {\huge\bfseries Biomass Open Origin Standard for Tracking (BOOST) \par}
    \vspace{1.5cm}
    {\LARGE W3C Community Group Final Specification \par}
    \vspace{0.8cm}
    {\Large Version {{VERSION}} \par}
    \vspace{0.5cm}
    {\Large August 13, 2025 \par}
    \vspace{3cm}
    {\large 
        Peter Tittmann \\
        Liam Killroy \\[0.5cm]
        BOOST W3C Community Group \par}
    \vfill
    \end{titlepage}
}

% Create alias for compatibility
\let\makewthreectitle\boosttitle

% RFC 2119 keyword commands that might be missing
\newcommand{\NOTRECOMMENDED}{\rfc{not recommended}}

\endinput